454filter
---------

This is a simple program meant to filter 454 FASTA and QUALITY score files
(both are required), optionally remove/split reads with poor q-scores and
optionally select only those reads that are TAGGED with a given 5' sequence.

To build, you need to use cmake. Type 

	$cmake [-DCMAKE_INSTALL_PREFIX=/install/path DEFAULT /usr/local/] ./
	$make install


USAGE
-----

    454filter <FASTA FILE> <QUAL FILE> <MIN Q-SCORE> <MIN CONTIG LENGTH> <FILTERING MODE> [5' TAG, MAXIMUM # OF MISMATCHES]
    
Try it from using the example file in 'data' by typing 

	454filter data/test.fna data/test.qual 15 30 0 ATATCGCGAGGA 0

Output: diagnostics written to stderr, so can be redirected)

stderr:
    READ STATISTICS
    Original     reads: 305
    Contributing reads: 5
    Retained fragments: 5
    
    Original read length distribution
    Mean          : 96.9508
    Median        : 77
    Variance      : 3743.03
    Standard Dev. : 61.1803
    Min           : 49
    2.5%          : 54
    97.5%         : 332
    Max           : 497
    
    Retained fragment length distribution
    Mean          : 41
    Median        : 37
    Variance      : 72.5
    Standard Dev. : 8.51469
    Min           : 33
    2.5%          : 33
    97.5%         : 54
    Max           : 54
  
stdout:
    >GM98SRO01B77KU RANK=0000671 X=796.0 Y=1996.0 LENGTH=58
    CCACGCGTATCGATGTCGACTTTTTTTTCTTTTCTTACATAGTAG
    >GM98SRO01BA3RP RANK=0000953 X=419.5 Y=1603.5 LENGTH=87
    CTGATGCTGCACCAACTGTACTCCCTCGCGATA
    >GM98SRO01E1BKW RANK=0001233 X=1948.0 Y=846.0 LENGTH=66
    TACAGTTGGTGCAGCATCAGAAAAGTACGACATCGATACGCGTGGTCCTCGCGA
    >GM98SRO01DVVNY RANK=0001304 X=1476.0 Y=636.5 LENGTH=84
    ACGGCTGATGCTGCACCAACTGTACTCCCTCGCGATA
    >GM98SRO01D6FIX RANK=0001416 X=1596.0 Y=1415.0 LENGTH=91
    CGGCTGATGCTGCACCAACTGTACTCCCTCGCGATA




ARGUMENTS
---------

	FASTA file 		: <required> 
                        path to the input FASTA file.
                        The .fna output file from the 454 instrument base caller (see data/test.fna)
                        Only ACGTN characters are recognized in the sequences

	QUAL file        : <required> 
                        path to the QUALITY file
                        The .qual file from the 454 instrument base caller (see data/test.qual)
                        MUST match the sequences from the FASTA file both in number and individual length

	MIN Q-SCORE 	  : <required> 
                        a real-valued number between >= 0.0. 
                        Used to filter low quality reads [suggested default 20] 
                        See 'FILTERING MODE' below
					  
	MIN CONTIG LENGTH : <required> 
						an interger >= 1
						Used to filter low quality reads [suggested default 50]
						See 'FILTERING MODE' below
						
	FILTERING MODE    : <required> 
	                    one of four values : 0, 1, 2, or 3
	                    
	                    0 -- truncate (no special treatment of homopolymers)
	                    1 -- split (no special treatment of homopolymers)
	                    2 -- truncate (retain homopolymers)
	                    3 -- split (retain hompolymers).
	                    
	                    The difference between truncate and split:
	                    
	                        Each RETAINED read is required to contain at least 
                            "MIN CONTIG LENGTH" contiguous bases with at least
                            "MIN Q-SCORE" q-score for each base. This span of 
                            high scoring bases does not have to begin at the 
                            5' end of the read. Any read that does not contain
                            such a span is discarded. If the mode is to truncate
                            then the FIRST such span is retained (the rest are 
                            ignored), while for the 'split' mode, each span is 
                            reported. 
                            
                            Consider a read of 400 bp, where the first 10 bases 
                            have q-scores < 20, and the bases 300-305 have
                            q-scores < 20 (all other bases have scores >=20). 
                            Thir read processed with MIN Q-SCORE = 20, and 
                            MIN CONTIG LENGTH = 50 will result in ONE span (base
                            11-299) for the 'truncate' mode, and in TWO spans 
                            (bases 11-299 and bases 306-400) for the 'split'
                            mode.
                            
                            When 'retain hompolymers' is on, then a low q-score
                            at bases 2,3,.. of a homopolymer (e.g. AAAA) do not
                            trigger a truncate or split event.
                            
     5' TAG             : <optional>
                          a string of nucleotides
                          When this option is supplied, only those reads whose
                          prefixes match (exactly or up to MAXIMUM # OF MISMATCHES)
                          this argument (the multiplexing ID tag). The tag itself is
                          stripped from each string, e.g. in the example above the
                          original 
	                      >GM98SRO01B77KU RANK=0000671 X=796.0 Y=1996.0 LENGTH=58
	                      read was   ATATCGCGAGGACCACGCGTATCGATGTCGACTTTTTTTTCTTTTCTTACATAGTAGT,
	                      but the output read is CCACGCGTATCGATGTCGACTTTTTTTTCTTTTCTTACATAGTAG
	                      (the last base is missing because of a poor q-score)
	                      
	                      
    MAXIMUM # OF MISMATCHES: <optional, only if 5' TAG is present>
                             an integer >=0 [DEFAULT value = 0]
                             If >0, then up to this many mismtaches are allowed between the MID
                             tag and the prefix of the read.
                             
	